<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" type="text/css" media="screen" href="../../css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="../../layuiadmin/layui/css/layui.css">
		<link rel="stylesheet" href="../../css/font-awesome/css/font-awesome.css" media="all" />
		<style>
			.layui-form-item{
				margin:0
			}
			.bcbtn{
				width:100%;
				margin-top:20px
			}
			
			.addbtn{
				/* display: block; */
				margin-left: 12%;
				margin-top:15px;
				width:32%;
				height:50px;
				line-height: 35px;
				border-style:dashed;
				color:royalblue 
			}
			.demoTable{
				position: fixed;
				left: 5%;
				bottom: 0px;
				width:90%;
				height:40px
			}
			.demoTable-btn{
				width:100%;
				height:40px;
			}	
			#sugItem{
				width:65%;
				float:right;
			}
			.cenglabel{
				width:10%;
				left:45%;
				position: absolute;
			}
		</style>
		

	</head>
	<body>
		<div class="layui-card">
			<div class="layui-card-body">
				<form class="layui-form layui-form-pane" onsubmit="return false" id="form">
					<input type="hidden" id="id" name="id">
					<!-- <div class='layui-form-item'>
						<label class='layui-form-label'>编码</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='编码' type='text' name='ccode' id='ccode'>
						</div>
					</div> -->
					<div class='layui-form-item'>
						<label class='layui-form-label'>客户名称</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='客户名称' type='text' name='cname' id='cname'>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>客户简称</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='客户简称' type='text' name='abbname' id='abbname'>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>客户分类</label>
						<div class='layui-input-block'>
<!-- 							<input class='layui-input' placeholder='客户分类' type='text' name='cid' id='cid'> -->
							<select class='layui-input' placeholder='客户分类' type='text' name='cid' id='cid'>
								<!-- <option value="5">运城客户</option>
								<option value="6">外地客户</option> -->
							</select>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>地址</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='地址' type='text' name='caddress' id='caddress'>
						</div>
					</div>

					<!-- <div class='layui-form-item'>
						<label class='layui-form-label'>注册码</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='注册码' type='text' name='cregcode' id='cregcode'>
						</div>
					</div> -->
					<div class='layui-form-item'>
						<label class='layui-form-label'>银行</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='银行' type='text' name='cbank' id='cbank'>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>账号</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='账号' type='text' name='caccount' id='caccount'>
						</div>
					</div>
					<!-- <div class='layui-form-item'>
						<label class='layui-form-label'>开发日期</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='开发日期' type='text' name='devdate' id='devdate'>
						</div>
					</div> -->
					<div class='layui-form-item'>
						<label class='layui-form-label'>联系人</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='联系人' type='text' name='cperson' id='cperson'>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>电话</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='电话' type='text' name='cphone' id='cphone'>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>电话2</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='电话2' type='text' name='cfax' id='cfax'>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>电话3</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='电话3' type='text' name='cemail' id='cemail'>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>电话4</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='电话4' type='text' name='cpostcode' id='cpostcode'>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>法人</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='法人' type='text' name='legalperson' id='legalperson'>
						</div>
					</div>
					<!-- <div class='layui-form-item'>
						<label class='layui-form-label'>照片</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='照片' type='text' name='pic' id='pic'>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>二维码</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='二维码' type='text' name='barcode' id='barcode'>
						</div>
					</div> -->
					<div class='layui-form-item'>
						<label class='layui-form-label'>信用额度</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='信用额度' type='text' name='xinyong' id='xinyong'>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>描述</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='描述' type='text' name='tdesc' id='tdesc'>
						</div>
					</div>
					<div class='layui-form-item'>
						<label class='layui-form-label'>备注</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='备注' type='text' name='memo' id='memo'>
						</div>
					</div>
					<!-- <div class='layui-form-item'>
						<label class='layui-form-label'>业务类型</label>
						<div class='layui-input-block'>
							<input class='layui-input' placeholder='业务类型' type='text' name='ctype' id='ctype'>
						</div>
					</div> -->
					<br/><br/>
	 <div>
    <button class="layui-btn bcbtn demoTable" type="submit" onclick="add()">
     <i class="fa fa-save"></i> 保存
    </button>
   </div>
				</form>
			</div>
			<script src="../../js/mui.min.js"></script>
			<script type="text/javascript" src="../../js/properties.js"></script>
			<script type="text/javascript" src="../../js/jquery.min.js"></script>
			<script type="text/javascript" src="../../js/jq.js"></script>
			<script type="text/javascript" src="../../js/common.js"></script>
			<script type="text/javascript" src="../../layuiadmin/layui/layui.js"></script>
			<script type="text/javascript" src="../../js/dict.js"></script>
			<script type="text/javascript" src="../../js/customrclass.js"></script>
			<script type="text/javascript">
				var id;
				//var appStatus = showStepSelect("stepid", "1", true);
				showcustomerclasssSelect("cid","deptcustomerclass",true);
				var token = JSON.parse(localStorage.getItem('$state')).token;
				var self = null;
				mui.plusReady(function() {
					self = plus.webview.currentWebview();
					id = self.bizid;
					if(id){
						initData(id);
					}
				

					mui.init({
						beforeback: function() {
							self.close();
						}
					});
				});
				
				layui.use(['layer', 'form', 'laydate'], function() {
					var layer = layui.layer;
					var form = layui.form;
				});
				
				function initData(id) {
					if (id != "") {
						$.ajax({
							type: 'get',
							url: server_url + '/customers/' + id,
							async: false,
							success: function(data) {
								$('#id').val(data.id);
								$('#ccode').val(data.ccode);
								$('#cname').val(data.cname);
								$('#abbname').val(data.abbname);
								$('#cid').val(data.cid);
								$('#caddress').val(data.caddress);
								$('#cpostcode').val(data.cpostcode);
								$('#cregcode').val(data.cregcode);
								$('#cbank').val(data.cbank);
								$('#caccount').val(data.caccount);
								$('#devdate').val(data.devdate);
								$('#cperson').val(data.cperson);
								$('#cphone').val(data.cphone);
								$('#cfax').val(data.cfax);
								$('#cemail').val(data.cemail);
								$('#legalperson').val(data.legalperson);
								$('#pic').val(data.pic);
								$('#barcode').val(data.barcode);
								$('#tdesc').val(data.tdesc);
								$('#memo').val(data.memo);
								$('#ctype').val(data.ctype);
								$('#xinyong').val(data.xinyong);
				
								renderForm(); //重新渲染表单
							}
						});
				
					}
				}
				
				function add() {

					var formdata = $("#form").serializeObject();
					var posttype="post";
					if (id){
						alert(id);
						posttype="put";
					}

					$.ajax({
						type: posttype,
						url: server_url + '/customers',
						contentType: "application/json; charset=utf-8",
						data: JSON.stringify(formdata),
						headers: {
							'token': token
						},
						success: function(data) {
							mui.plusReady(function() {
								var clist = plus.webview.getWebviewById("customerList.html");
								mui.fire(clist, 'refresh');
								layer.msg("保存成功", {
									shift: -1,
									time: 1000
								}, function() {
									self.close();
								});
							})
						}
					});
				}
			</script>
	</body>
</html>
